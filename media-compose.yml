version: '3.3'

services:
  jellyfin:
    image: jellyfin/jellyfin:latest
    container_name: jellyfin
    restart: unless-stopped
    user: 1000:1000
    ports:
      - 8096:8096
    volumes:
      - jellyfin-config:/config
      - jellyfin-cache:/cache
      - /mnt/media/tv_shows:/tv_shows
      - /mnt/media/movies:/movies
    networks:
      - proxy
      - arr_network

  jellyseerr:
    image: fallenbagel/jellyseerr:latest
    container_name: jellyseerr
    restart: unless-stopped
    environment:
      TZ: America/Los_Angeles
    volumes:
      - jellyseerr:/app/config
    networks:
      - proxy
      - arr_network

  sonarr:
    image: linuxserver/sonarr:latest
    container_name: sonarr
    restart: unless-stopped
    environment:
      TZ: America/Los_Angeles
      PUID: 1000
      PGID: 1000
    volumes:
      - sonarr:/config
      - /mnt/media/tv_shows:/tv_shows
      - /mnt/media/transmission:/downloads
    networks:
      - proxy
      - arr_network

  sonarr-4k:
    image: linuxserver/sonarr:latest
    container_name: sonarr-4k
    restart: unless-stopped
    depends_on:
      - sonarr
    environment:
      TZ: America/Los_Angeles
      PUID: 1000
      PGID: 1000
    volumes:
      - sonarr-4k:/config
      - /mnt/media/tv_shows:/tv_shows
      - /mnt/media/transmission:/downloads
    networks:
      - proxy
      - arr_network

  radarr:
    image: linuxserver/radarr:latest
    container_name: radarr
    restart: unless-stopped
    environment:
      TZ: America/Los_Angeles
      PUID: 1000
      PGID: 1000
    volumes:
      - radarr:/config
      - /mnt/media/transmission:/downloads
      - /mnt/media/movies:/movies
    networks:
      - proxy
      - arr_network

  radarr-4k:
    image: linuxserver/radarr:latest
    container_name: radarr-4k
    restart: unless-stopped
    depends_on:
      - radarr
    environment:
      TZ: America/Los_Angeles
      PUID: 1000
      PGID: 1000
    volumes:
      - radarr-4k:/config
      - /mnt/media/transmission:/downloads
      - /mnt/media/movies:/movies
    networks:
      - proxy
      - arr_network

  readarr:
    image: linuxserver/readarr:develop
    container_name: readarr
    restart: unless-stopped
    environment:
      TZ: America/Los_Angeles
      PUID: 1000
      PGID: 1000
    volumes:
      - readarr:/config
      - /mnt/media/books:/books
      - /mnt/media/transmission:/downloads
    networks:
      - proxy
      - arr_network

  speakarr:
    image: linuxserver/readarr:develop
    container_name: speakarr
    restart: unless-stopped
    environment:
      TZ: America/Los_Angeles
      PUID: 1000
      PGID: 1000
    volumes:
      - speakarr:/config
      - /mnt/media/books:/books
      - /mnt/media/transmission:/downloads
    networks:
      - proxy
      - arr_network

  lazylibrarian:
    image: linuxserver/lazylibrarian:latest
    container_name: lazylibrarian
    restart: unless-stopped
    environment:
      TZ: America/Los_Angeles
      PUID: 1000
      PGID: 1000
    volumes:
      - lazylibrarian:/config
      - /mnt/media/books:/books
      - /mnt/media/transmission:/downloads
    networks:
      - proxy
      - arr_network

  prowlarr:
    image: linuxserver/prowlarr:latest
    container_name: prowlarr
    restart: unless-stopped
    environment:
      TZ: America/Los_Angeles
      PUID: 1000
      PGID: 1000
    volumes:
      - prowlarr:/config
    networks:
      - proxy
      - arr_network

  gluetun:
    image: qmcgaw/gluetun:latest
    container_name: gluetun
    restart: always
    cap_add:
      - NET_ADMIN
    devices:
      - /dev/net/tun:/dev/net/tun
    volumes:
      - gluetun:/gluetun
    environment:
      TZ: America/Los_Angeles
      VPN_SERVICE_PROVIDER: nordvpn
      VPN_TYPE: openvpn
      OPENVPN_USER: $VPN_USERNAME
      OPENVPN_PASSWORD: $VPN_PASSWORD
      UPDATER_PERIOD: 24h
    networks:
      - proxy
      - arr_network

  gluetun-cron:
    image: curlimages/curl:latest
    container_name: gluetun-cron
    restart: unless-stopped
    network_mode: service:gluetun
    user: root
    command: sh /config/entrypoint.sh
    volumes:
      - /home/docker/gluetun-cron:/config

  unpackerr:
    image: golift/unpackerr:latest
    container_name: unpackerr
    restart: unless-stopped
    environment:
      TZ: America/Los_Angeles
      UN_SONARR_0_URL: http://sonarr:8989
      UN_SONARR_0_API_KEY: $SONARR_API_KEY
      UN_SONARR_0_PATHS_0: /data/complete/sonarr
      UN_RADARR_0_URL: http://radarr:7878
      UN_RADARR_0_API_KEY: $RADARR_API_KEY
      UN_RADARR_0_PATHS_0: /data/complete/radarr
    volumes:
      - /mnt/media/transmission:/data
    networks:
      - arr_network

  transmission:
    image: linuxserver/transmission:latest
    container_name: transmission
    restart: unless-stopped
    network_mode: service:gluetun
    environment:
      TZ: America/Los_Angeles
      PUID: 1000
      PGID: 1000
    volumes:
      - transmission-config:/config
      - /mnt/media/transmission:/downloads
      - /mnt/media/transmission/watch:/watch

  tachidesk:
    image: ghcr.io/suwayomi/tachidesk:preview
    container_name: tachidesk
    restart: unless-stopped
    network_mode: service:gluetun
    environment:
      TZ: America/Los_Angeles
      DOWNLOAD_AS_CBZ: true
      WEB_UI_ENABLED: true
      WEB_UI_FLAVOR: WebUI
      WEB_UI_CHANNEL: preview
      WEB_UI_UPDATE_INTERVAL: 12
      AUTO_DOWNLOAD_CHAPTERS: true
      AUTO_DOWNLOAD_EXCLUDE_UNREAD: false
      AUTO_DOWNLOAD_AHEAD_LIMIT: 20
      UPDATE_EXCLUDE_UNREAD: false
      UPDATE_EXCLUDE_STARTED: false
      UPDATE_EXCLUDE_COMPLETED: true
      UPDATE_INTERVAL: 12
      UPDATE_MANGA_INFO: true
      FLARESOLVERR_ENABLED: false
    volumes:
      - /home/docker/tachidesk:/home/suwayomi/.local/share/Tachidesk

  audiobookshelf:
    image: ghcr.io/advplyr/audiobookshelf:latest
    container_name: audiobookshelf
    volumes:
      - /mnt/media/books:/books
      - audiobookshelf-config:/config
      - audiobookshelf-metadata:/metadata
    networks:
      - proxy

volumes:
  jellyfin-config:
  jellyfin-cache:
  jellyseerr:
  readarr:
  speakarr:
  lazylibrarian:
  sonarr:
  sonarr-4k:
  radarr:
  radarr-4k:
  prowlarr:
  transmission-config:
  audiobookshelf-config:
  audiobookshelf-metadata:
  gluetun:

networks:
  arr_network:
  proxy:
    external: true
